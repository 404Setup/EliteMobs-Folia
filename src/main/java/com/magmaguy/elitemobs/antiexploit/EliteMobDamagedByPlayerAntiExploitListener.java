package com.magmaguy.elitemobs.antiexploit;

import com.magmaguy.elitemobs.MetadataHandler;
import com.magmaguy.elitemobs.api.EliteMobDamagedByPlayerAntiExploitEvent;
import org.bukkit.event.EventHandler;
import org.bukkit.event.EventPriority;
import org.bukkit.event.Listener;
import org.bukkit.scheduler.BukkitRunnable;

public class EliteMobDamagedByPlayerAntiExploitListener implements Listener {
    @EventHandler(priority = EventPriority.MONITOR)
    public void onDamage(EliteMobDamagedByPlayerAntiExploitEvent event) {
        if (event.isTriggered()) return;
        event.getEliteMobEntity().decrementAntiExploit(5);
        event.getEliteMobEntity().setInAntiExploitCooldown(true);
        new BukkitRunnable() {
            @Override
            public void run() {
                if (event.getEliteMobEntity() != null)
                    event.getEliteMobEntity().setInAntiExploitCooldown(false);
            }
        }.runTaskLater(MetadataHandler.PLUGIN, 20 * 3);
    }
}
